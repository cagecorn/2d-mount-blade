# Arena Integration Plan

이 문서는 본 게임의 전투 로직을 아레나 모드에서 동일하게 활용하기 위한 단계별 로드맵을 정리합니다. 현재 아레나 모드에서는 실험적인 TensorFlow 기반 컨트롤러와 간소화된 전투 규칙만 적용되어 있습니다. 아래 순서대로 기존 매니저와 시스템을 점진적으로 연동하며 안정성을 확보하는 것이 목표입니다.

## 1단계: 핵심 매니저 연결 점검
- `CombatEngine`, `MovementManager`, `MotionManager` 등 전투 흐름에 직접 관여하는 매니저를 ArenaEngine 초기화 시 함께 활성화합니다.
- 아레나 전용 매니저가 기존 시스템과 중복되는 부분이 없는지 정리합니다.
- 필요 시 `ArenaManager`가 해당 매니저들의 참조를 받아 사용하도록 인터페이스를 확립합니다.

## 2단계: 스킬/아이템/직업 데이터 공유 ✅
- 본 게임에서 사용 중인 `data/skills.js`, `data/items.js`, `data/jobs.js`의 전체 내용을 아레나에서도 공통으로 로드하도록 수정합니다.
- 테스트 격리 유지를 위해 아레나용 더미 데이터를 별도로 두었다면 제거하고 공통 데이터 모듈만 사용합니다.
- 데이터 구조가 변경될 경우 `tests/unit/dataIntegrity.test.js`를 갱신합니다.

## 3단계: AI 로직 통합 ✅
- 기존 전투에서 검증된 `DecisionEngine`, `FluctuationEngine`, `MistakeEngine`을 아레나 유닛 컨트롤러에서 동일하게 호출합니다.
- TensorFlow 컨트롤러가 활성화되어 있을 때는 기존 엔진과 충돌하지 않도록 우선순위를 명시합니다.
- AI 동작 변화는 `tests/unit/ai.test.js` 및 통합 테스트 시나리오로 검증합니다.

## 4단계: 전투 기록 및 로그 통합
- 아레나에서도 `FileLogManager`와 `dataRecorder`가 동작하도록 설정하여, 전투 결과를 동일 포맷으로 저장합니다.
- `arena_log` 이벤트 형식을 본 게임의 `log` 이벤트와 일치시키고, 테스트 스크립트에서 두 이벤트를 모두 수집해 비교합니다.

## 5단계: 밸런스 검증을 위한 시뮬레이션
- `arena-simulation.mjs`를 활용하여 여러 차례 전투를 자동 실행하고, 결과를 `codex's room`과 `TensorFlow's room`에 기록합니다.
- 시뮬레이션 중 이상치(한쪽 팀의 완승만 반복 등)가 발견되면 관련 AI 또는 데이터 수치를 조정합니다.

## 6단계: 탠설 플로우(TensorFlow 기반 AI) 적용
- 위 단계들이 안정화된 후, TensorFlow 모델을 로드하여 아레나 유닛의 의사결정에 개입시킵니다.
- 모델의 출력이 기존 AI 엔진의 결정과 상충할 경우 우선순위 규칙을 세우고 테스트로 검증합니다.

이상의 과정을 완료하면 아레나 모드에서도 본 게임과 동일한 전투 메커니즘이 작동하면서, 추가적으로 탠설 플로우 AI가 개입하는 구조를 확보할 수 있습니다.
